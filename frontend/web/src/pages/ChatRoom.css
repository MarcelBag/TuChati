/* ===========================================
   TuChati Chat Room - refined + grouped UI
   =========================================== */

:root{
  --bg:#0b0f14; --panel:#0f1520; --elev:#0b1220; --text:#e6edf3; --muted:#8aa0b6;
  --ring:#3b82f6; --subtle:#10161f;
  --me:#3b82f6; --me-text:#fff;
  --other:#eef2f7; --other-text:#0b1220;
  --border:rgba(148,163,184,.16); --hover:rgba(255,255,255,.05); --active:rgba(255,255,255,.08);
}
html.light{
  --bg:#f6f8fb; --panel:#fff; --elev:#fff; --text:#0b1220; --muted:#516273; --ring:#3b82f6; --subtle:#f3f5f8;
  --me:#3b82f6; --me-text:#fff; --other:#eef2f7; --other-text:#0b1220; --border:rgba(2,6,23,.1);
  --hover:rgba(0,0,0,.04); --active:rgba(0,0,0,.08);
}

/* pane */
.chat-pane{display:flex;flex-direction:column;background:var(--elev);height:100vh;overflow:hidden}
.chat-hd{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-bottom:1px solid var(--border);background:var(--panel);min-height:60px;position:sticky;top:0;z-index:10}
.chat-hd .title{display:flex;align-items:center;gap:14px}
.chat-hd .name{font-weight:600;font-size:16px;color:var(--text)}
.chat-hd .sub{color:var(--muted);font-size:13px;margin-top:2px}

/* avatars */
.avatar-badge{width:40px;height:40px;min-width:40px;border-radius:50%;background:linear-gradient(135deg,#3b82f6,#06b6d4);display:grid;place-items:center;color:#fff;font-weight:700;font-size:16px;text-transform:uppercase}
.avatar-badge.lg{width:44px;height:44px;font-size:18px}
.avatar-badge.sm{width:32px;height:32px;font-size:14px;flex-shrink:0}

/* scroll */
.chat-scroll{flex:1;overflow-y:auto;padding:18px 36px 96px 24px;background:var(--subtle);
  background-image:radial-gradient(circle at 20% 50%,rgba(59,130,246,.03) 0%,transparent 50%),radial-gradient(circle at 80% 80%,rgba(6,182,212,.03) 0%,transparent 50%);
  display:flex;flex-direction:column;gap:6px;scroll-behavior:smooth}
.chat-scroll::-webkit-scrollbar{width:6px}
.chat-scroll::-webkit-scrollbar-thumb{background:rgba(0,0,0,.16);border-radius:3px}

/* day separator */
.day-sep{display:flex;justify-content:center;margin:12px 0}
.day-sep span{font-size:12px;color:var(--muted);background:rgba(0,0,0,.06);padding:4px 10px;border-radius:999px}
html:not(.light) .day-sep span{background:rgba(255,255,255,.06)}

/* rows (grouped) */
.row{display:flex;gap:8px;max-width:70%;align-items:flex-end;margin:2px 0}
.row.left{align-self:flex-start}
.row.right{align-self:flex-end;margin-left:auto;flex-direction:row-reverse;justify-content:flex-end}

/* bubbles */
.bubble{position:relative;background:var(--other);color:var(--other-text);padding:10px 12px 18px;border-radius:14px;box-shadow:0 1px 2px rgba(0,0,0,.06);word-wrap:break-word;min-width:64px}
.bubble.me{background:var(--me);color:var(--me-text)}
.bubble p{margin:0;white-space:pre-wrap;word-break:break-word;line-height:1.55;font-size:15px;padding-right:8px}
.bubble .attach{color:inherit;text-decoration:underline;opacity:.9;font-size:14px}
.bubble .attach:hover{opacity:1}

/* timestamp */
.bubble .time{position:absolute;right:10px;bottom:6px;font-size:11px;color:currentColor;opacity:.6;white-space:nowrap}
.bubble.me .time{color:rgba(255,255,255,.85)}

/* tails only when .tail present (last in block) */
.bubble.tail::after{content:"";position:absolute;bottom:0;width:12px;height:12px;background:inherit;clip-path:polygon(0 0,100% 100%,0 100%)}
.row.left .bubble.tail::after{left:-5px;transform:translateY(-1px)}
.row.right .bubble.tail::after{right:-5px;transform:translateY(-1px) scaleX(-1)}

/* composer */
.composer{display:grid;grid-template-columns:auto 1fr auto;gap:10px;padding:14px 20px;border-top:1px solid var(--border);background:var(--panel);position:sticky;bottom:0;align-items:center}
.composer-left{display:flex;gap:8px;align-items:center;position:relative}
.icon-btn{width:36px;height:36px;border-radius:10px;border:1px solid var(--border);background:var(--elev);color:var(--text);cursor:pointer}
.icon-btn:hover{background:var(--hover)}
.attach-menu{position:absolute;bottom:48px;left:0;background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:6px;box-shadow:0 12px 30px rgba(0,0,0,.25)}
.attach-item{display:block;width:190px;padding:10px 12px;border-radius:8px;color:var(--text);background:transparent;border:none;text-align:left;cursor:pointer}
.attach-item:hover{background:var(--hover)}
.composer input{flex:1;padding:12px 16px;border-radius:12px;border:1px solid var(--border);background:var(--elev);color:var(--text);font-size:15px;outline:none;transition:all .2s}
.composer input::placeholder{color:var(--muted)}
.composer input:focus{border-color:var(--ring);background:var(--panel);box-shadow:0 0 0 3px rgba(59,130,246,.12)}
.send{width:44px;height:44px;border-radius:50%;border:none;background:var(--ring);color:#fff;font-size:18px;cursor:pointer;display:grid;place-items:center;transition:all .2s;flex-shrink:0}
.send:hover{transform:scale(1.05)}
.send:active{transform:scale(.96)}
.send.mic{font-size:20px}
.send.mic.recording{background:#ef4444}

/* context menu */
.ctx-wrap{position:fixed;inset:0;z-index:20}
.menu.ctx{position:absolute;transform:translate(-50%,6px);min-width:220px;padding:6px;border-radius:12px;background:var(--panel);border:1px solid var(--border);box-shadow:0 10px 30px rgba(0,0,0,.25)}
.menu-item{width:100%;text-align:left;padding:10px 12px;background:transparent;border:none;color:var(--text);cursor:pointer;border-radius:8px}
.menu-item:hover{background:var(--hover)}
.menu-item.danger{color:#ef4444}

/* right drawer */
.room-info{position:fixed;top:60px;right:-340px;width:320px;height:calc(100vh - 60px);background:var(--panel);border-left:1px solid var(--border);box-shadow:-6px 0 24px rgba(0,0,0,.15);transition:right .2s;z-index:12;padding:14px 16px;overflow-y:auto}
.room-info.open{right:0}
.room-info-hd{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.ri-meta h4{margin:0;color:var(--text)}
.ri-meta p{margin:2px 0 0;color:var(--muted);font-size:13px}
.ri-section{margin-top:16px}
.ri-title{font-weight:600;color:var(--text);margin-bottom:8px}
.ri-list{list-style:none;margin:0;padding:0}
.ri-list li{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid rgba(0,0,0,.06)}
.ri-avatar{width:28px;height:28px;border-radius:50%;display:grid;place-items:center;font-size:13px;font-weight:700;color:#fff;background:linear-gradient(135deg,#3b82f6,#06b6d4)}
.ri-name{flex:1;color:var(--text);overflow:hidden;text-overflow:ellipsis}
.ri-action{border:none;background:transparent;color:#ef4444;cursor:pointer}
.ri-close{margin-left:auto;border:0;background:transparent;font-size:18px;color:var(--muted);cursor:pointer}
.ri-close:hover{color:var(--text)}

@media (max-width:768px){
  .row{max-width:85%}
  .chat-hd{padding:10px 16px}
  .composer{padding:12px 16px}
}

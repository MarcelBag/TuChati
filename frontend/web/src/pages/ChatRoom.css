/* src/pages/ChatRoom.css */
/* ===========================================
   TuChati Chat Room - Sender vs Receiver UI
   =========================================== */

:root {
  --bg: #0b0f14;
  --panel: #101624;
  --elev: #0d1421;
  --text: #e6edf3;
  --muted: #8aa0b6;
  --ring: #3b82f6;
  --subtle: #111826;
  --bubble-me: #2563eb;
  --bubble-me-text: #ffffff;
  --bubble-other: rgba(255, 255, 255, 0.07);
  --bubble-other-text: #e6edf3;
  --border: rgba(148, 163, 184, 0.18);
  --hover: rgba(255, 255, 255, 0.08);
  --active: rgba(255, 255, 255, 0.12);
  --wave-passive: rgba(148, 197, 255, 0.6);
  --wave-active: rgba(61, 139, 255, 0.98);
  --voice-chip-bg: rgba(59, 130, 246, 0.16);
  --voice-control: rgba(59, 130, 246, 0.28);
  --voice-control-text: #ffffff;
}

html.light {
  --bg: #f6f8fc;
  --panel: #ffffff;
  --elev: #ffffff;
  --text: #0b1220;
  --muted: #586a81;
  --ring: #3b82f6;
  --subtle: #f2f5fb;
  --bubble-me: #3b82f6;
  --bubble-me-text: #ffffff;
  --bubble-other: rgba(15, 23, 42, 0.06);
  --bubble-other-text: #0b1220;
  --border: rgba(2, 6, 23, 0.12);
  --hover: rgba(15, 23, 42, 0.06);
  --active: rgba(15, 23, 42, 0.1);
  --wave-passive: rgba(37, 99, 235, 0.35);
  --wave-active: rgba(37, 99, 235, 0.95);
  --voice-chip-bg: rgba(37, 99, 235, 0.12);
  --voice-control: rgba(37, 99, 235, 0.1);
  --voice-control-text: #0b1220;
}

/* Layout */
.chat-pane { display: flex; flex-direction: column; background: var(--elev); height: 100vh; overflow: hidden; }
.chat-hd {
  display: flex; align-items: center; justify-content: space-between;
  padding: 12px 20px; border-bottom: 1px solid var(--border);
  background: var(--panel); min-height: 60px; position: sticky; top: 0; z-index: 10;
}
.chat-hd .title { display: flex; align-items: center; gap: 14px; }
.chat-hd .name { font-weight: 600; font-size: 16px; color: var(--text); margin: 0; }
.chat-hd .sub  { color: var(--muted); font-size: 13px; margin-top: 2px; }
.ri-tip { font-size: 12px; color: var(--muted); margin-left: 6px; }

/* Avatars */
.avatar-badge {
  width: 40px;
  height: 40px;
  min-width: 40px;
  border-radius: 50%;
  overflow: hidden;
  background: linear-gradient(135deg, #3b82f6, #06b6d4);
  display: grid;
  place-items: center;
  color: #fff;
  font-weight: 700;
  font-size: 16px;
  text-transform: uppercase;
  flex-shrink: 0;
}
.avatar-badge.lg { width: 44px; height: 44px; font-size: 18px; min-width: 44px; }
.avatar-badge.sm { width: 32px; height: 32px; font-size: 14px; flex-shrink: 0; }
button.avatar-badge { border: none; background: transparent; padding: 0; cursor: pointer; }
button.avatar-badge:focus-visible { outline: 2px solid var(--ring); outline-offset: 3px; }
.avatar-badge.has-image { background: transparent; }
.avatar-badge.has-image img{display:block;width:100%;height:100%;border-radius:50%;object-fit:cover}

/* Scroll */
.chat-scroll {
  flex: 1; overflow-y: auto; padding: 20px 36px 96px 24px;
  background: var(--subtle);
  background-image:
    radial-gradient(circle at 20% 50%, rgba(59,130,246,0.03) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(6,182,212,0.03) 0%, transparent 50%);
  display: flex; flex-direction: column; gap: 8px; scroll-behavior: smooth;
}
.chat-scroll::-webkit-scrollbar { width: 6px; }
.chat-scroll::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.16); border-radius: 3px; }

/* Bubbles */
.bubble-row { display: flex; gap: 8px; margin: 6px 0; max-width: 64%; align-items: flex-end; animation: slideIn .18s ease; }
@keyframes slideIn { from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }
.bubble-row.left  { align-self: flex-start; }
.bubble-row.right { align-self: flex-end; margin-left: auto; justify-content: flex-end; flex-direction: row-reverse; }

.bubble {
  position: relative;
  background: var(--bubble-other);
  color: var(--bubble-other-text);
  padding: 10px 12px 18px;
  border-radius: 14px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.08);
  word-wrap: break-word; max-width: 100%; min-width: 80px;
}
.bubble.other { background: var(--bubble-other); color: var(--bubble-other-text); }
.bubble.me    { background: var(--bubble-me);    color: var(--bubble-me-text); }

.bubble p { margin: 0; white-space: pre-wrap; word-break: break-word; line-height: 1.5; font-size: 14px; padding-right: 8px; }
.bubble .attach { color: inherit; text-decoration: underline; opacity: 0.9; font-size: 14px; }
.bubble .attach:hover { opacity: 1; }

/* Timestamp */
.bubble .time {
  position: absolute; right: 10px; bottom: 6px;
  font-size: 11px; color: currentColor; opacity: .65; white-space: nowrap;
}
.bubble.me .time { color: rgba(255,255,255,0.85); }
html.light .bubble .time { opacity: .55; }
.time .status-icon{display:inline-flex;align-items:center;font-size:.78rem;margin-left:4px;gap:2px;opacity:.8}
.time .status-icon.status-sent{opacity:.6}
.time .status-icon.status-delivered{opacity:.75}
.time .status-icon.status-read{opacity:1;color:var(--ring)}
.bubble.me .time .status-icon{color:rgba(255,255,255,.85)}
.bubble.me .time .status-icon.status-read{color:#dbeafe}

/* Bubble tails */
.bubble::after { display: none; }

/* Composer */
.composer {
  display: grid; grid-template-columns: auto 1fr auto; gap: 10px;
  padding: 14px 20px; border-top: 1px solid var(--border);
  background: var(--panel); position: sticky; bottom: 0; align-items: center;
}
.composer-left { display: flex; gap: 8px; align-items: center; position: relative; }
.icon-btn {
  width: 36px; height: 36px; border-radius: 10px;
  border: 1px solid var(--border); background: var(--subtle); color: var(--text); cursor: pointer;
}
.icon-btn:hover { background: var(--hover); }

.attach-menu {
  position: absolute; bottom: 48px; left: 0;
  background: var(--panel); border: 1px solid var(--border);
  border-radius: 12px; padding: 6px; box-shadow: 0 12px 30px rgba(0,0,0,.25);
}
.attach-item {
  display: block; width: 180px; padding: 10px 12px; border-radius: 8px;
  color: var(--text); background: transparent; border: none; text-align: left; cursor: pointer;
}
.attach-item:hover { background: var(--hover); }

.composer input {
  flex: 1; padding: 12px 16px; border-radius: 10px; border: 1px solid var(--border);
  background: var(--subtle); color: var(--text); font-size: 15px; outline: none; transition: all .2s ease;
}
.composer input::placeholder { color: var(--muted); }
.composer input:focus { border-color: var(--ring); background: var(--elev); box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }

.send {
  width: 44px; height: 44px; border-radius: 50%; border: none; background: var(--ring);
  color: #fff; font-size: 18px; cursor: pointer; display: grid; place-items: center; transition: all .2s ease; flex-shrink: 0;
}
.send:hover { background: #2563eb; transform: scale(1.05); }
.send:active { transform: scale(.95); }
.send.mic { font-size: 20px; }
.send.mic.recording { background: #ef4444; }

/* Recording pill (optional) */
.rec-pill {
  position: fixed; bottom: 88px; right: 24px; background: rgba(239,68,68,.95);
  color: #fff; padding: 8px 12px; border-radius: 999px; z-index: 15; font-size: 13px; box-shadow: 0 8px 24px rgba(0,0,0,.25);
}

/* Context menu */
.ctx-wrap { position: fixed; inset: 0; z-index: 20; }
.menu.ctx {
  position: absolute; transform: translate(-50%, 6px);
  min-width: 220px; padding: 6px; border-radius: 12px; background: var(--panel);
  border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,.25);
}
.menu-item { width: 100%; text-align: left; padding: 10px 12px; background: transparent; border: none; color: var(--text); cursor: pointer; border-radius: 8px; }
.menu-item:hover { background: var(--hover); }
.menu-item.danger { color: #ef4444; }

/* Right drawer */
.room-info { position: fixed; top: 60px; right: -340px; width: 320px; height: calc(100vh - 60px); background: var(--panel); border-left: 1px solid var(--border); box-shadow: -6px 0 24px rgba(0,0,0,.15); transition: right .2s ease; z-index: 12; padding: 14px 16px; overflow-y: auto; }
.room-info.open { right: 0; }
.room-info-hd { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
.room-info-hd.direct { align-items: flex-start; }
.ri-meta h4 { margin: 0; color: var(--text); }
.ri-meta p { margin: 2px 0 0; color: var(--muted); font-size: 13px; }
.ri-section { margin-top: 16px; }
.ri-title { font-weight: 600; color: var(--text); margin-bottom: 8px; }
.ri-list { list-style: none; margin: 0; padding: 0; }
.ri-list li { display: flex; align-items: center; gap: 10px; padding: 8px 0; border-bottom: 1px solid rgba(0,0,0,.06); }
.ri-avatar { width: 28px; height: 28px; min-width: 28px; border-radius: 50%; overflow: hidden; display: grid; place-items: center; font-size: 13px; font-weight: 700; color: #fff; background: linear-gradient(135deg, #3b82f6, #06b6d4); }
.ri-avatar.has-image { background: transparent; }
.ri-avatar.has-image img { display: block; width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
.ri-name { flex: 1; color: var(--text); overflow: hidden; text-overflow: ellipsis; }
.ri-action { border: none; background: transparent; color: #ef4444; cursor: pointer; }
.ri-close { margin-left:auto; border:0; background:transparent; font-size:18px; color:var(--muted); cursor:pointer; }
.ri-close:hover{ color: var(--text); }
.ri-profile { display: flex; flex-direction: column; gap: 16px; }
.ri-profile-avatar { width: 72px; height: 72px; border-radius: 50%; overflow: hidden; background: linear-gradient(135deg,#3b82f6,#06b6d4); display: grid; place-items: center; font-size: 24px; font-weight: 700; color: #fff; flex-shrink: 0; }
.ri-profile-avatar.has-image { cursor: zoom-in; overflow: hidden; }
.ri-profile-avatar.has-image img { display: block; width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
.ri-profile-avatar.has-image:focus-visible { outline: 2px solid var(--ring); outline-offset: 4px; }
.ri-profile-avatar span { text-transform: uppercase; }
.ri-username { margin: 0; color: var(--muted); font-size: 13px; }
.ri-status-block { display: flex; flex-direction: column; gap: 4px; margin-top: 6px; }
.ri-status-badge { display: inline-flex; align-items: center; gap: 6px; font-size: 12px; padding: 4px 8px; border-radius: 999px; background: rgba(59,130,246,.18); color: var(--text); width: fit-content; }
.ri-status-badge.online { background: rgba(34,197,94,0.16); color: #4ade80; }
html.light .ri-status-badge.online { color: #15803d; background: rgba(34,197,94,0.18); }
.ri-status-sub { color: var(--muted); font-size: 12px; }
.ri-status-message { margin: 0; color: var(--text); font-size: 14px; line-height: 1.5; }
.ri-status-message.muted { color: var(--muted); font-style: italic; }
.ri-bio { margin: 0; color: var(--text); font-size: 14px; line-height: 1.6; white-space: pre-wrap; }
.ri-bio.muted { color: var(--muted); font-style: italic; }
.ri-profile-details { display: grid; gap: 12px; }
.ri-detail-row { display: flex; flex-direction: column; gap: 4px; }
.ri-detail-label { font-size: 11px; text-transform: uppercase; letter-spacing: .05em; color: var(--muted); }
.ri-detail-value { font-size: 14px; color: var(--text); word-break: break-word; white-space: pre-wrap; }
.ri-detail-value.muted { color: var(--muted); font-style: italic; }
.ri-detail-heading { margin: 20px 0 12px; font-size: 11px; text-transform: uppercase; letter-spacing: .08em; color: var(--muted); }
.ri-loading,
.ri-error,
.ri-empty { margin: 0; font-size: 14px; }
.ri-loading { color: var(--muted); }
.ri-empty { color: var(--muted); font-style: italic; }
.ri-error { color: #ef4444; }

/* Responsive */
@media (max-width: 768px) {
  .bubble-row { max-width: 85%; }
  .chat-hd { padding: 10px 16px; }
  .composer { padding: 12px 16px; }
}

/* ===========================================
   TuChati Chat Room - refined + grouped UI
   + per-bubble kebab, reactions, timestamp padding
   =========================================== */

:root{
  --bg:#0b0f14;
  --panel:#0f1520;
  --elev:#0b1220;
  --text:#e6edf3;
  --muted:#8aa0b6;
  --ring:#3b82f6;
  --subtle:#111826;
  --me:#3b82f6;
  --me-text:#fff;
  --other:rgba(255,255,255,0.07);
  --other-text:#e6edf3;
  --border:rgba(148,163,184,.16);
  --hover:rgba(255,255,255,0.08);
  --active:rgba(255,255,255,0.12);
}

html.light{
  --bg:#f6f8fb;
  --panel:#fff;
  --elev:#fff;
  --text:#0b1220;
  --muted:#516273;
  --ring:#3b82f6;
  --subtle:#f3f5f8;
  --me:#3b82f6;
  --me-text:#fff;
  --other:#eef2f7;
  --other-text:#0b1220;
  --border:rgba(2,6,23,.1);
  --hover:rgba(0,0,0,.04);
  --active:rgba(0,0,0,.08);
}

/* pane/header */
.chat-pane{display:flex;flex-direction:column;background:var(--elev);height:100vh;overflow:hidden}
.chat-hd{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-bottom:1px solid var(--border);background:var(--panel);min-height:60px;position:sticky;top:0;z-index:10}
.chat-hd .title{display:flex;align-items:center;gap:14px}
.chat-hd .name{font-weight:600;font-size:16px;color:var(--text)}
.chat-hd .sub{color:var(--muted);font-size:13px;margin-top:2px}

/* avatars */
.avatar-badge{width:40px;height:40px;min-width:40px;border-radius:50%;overflow:hidden;background:linear-gradient(135deg,#3b82f6,#06b6d4);display:grid;place-items:center;color:#fff;font-weight:700;font-size:16px;text-transform:uppercase;flex-shrink:0}
.avatar-badge.lg{width:44px;height:44px;font-size:18px;min-width:44px}
.avatar-badge.sm{width:32px;height:32px;font-size:14px;flex-shrink:0}
button.avatar-badge{border:none;background:transparent;padding:0;cursor:pointer}
button.avatar-badge:focus-visible{outline:2px solid var(--ring);outline-offset:3px}
.avatar-badge.has-image{background:transparent}
.avatar-badge.has-image img{display:block;width:100%;height:100%;border-radius:50%;object-fit:cover}

/* scroll */
.chat-scroll{flex:1;overflow-y:auto;padding:18px 36px 96px 24px;background:var(--subtle);
  background-image:radial-gradient(circle at 20% 50%,rgba(59,130,246,.03) 0%,transparent 50%),radial-gradient(circle at 80% 80%,rgba(6,182,212,.03) 0%,transparent 50%);
  display:flex;flex-direction:column;gap:6px;scroll-behavior:smooth}
.chat-scroll::-webkit-scrollbar{width:6px}
.chat-scroll::-webkit-scrollbar-thumb{background:rgba(0,0,0,.16);border-radius:3px}

/* day separator */
.day-sep{display:flex;justify-content:center;margin:12px 0}
.day-sep span{font-size:12px;color:var(--muted);background:rgba(0,0,0,.06);padding:4px 10px;border-radius:999px}
html:not(.light) .day-sep span{background:rgba(255,255,255,.08)}

/* rows */
.row{display:flex;gap:8px;max-width:70%;align-items:flex-end;margin:2px 0}
.row.left{align-self:flex-start}
.row.right{align-self:flex-end;margin-left:auto;flex-direction:row-reverse;justify-content:flex-end}

/* bubbles */
.bubble{position:relative;background:var(--other);color:var(--other-text);padding:10px 12px 18px;border-radius:14px;box-shadow:0 1px 2px rgba(0,0,0,.06);word-wrap:break-word;min-width:64px}
.bubble.me{background:var(--me);color:var(--me-text)}
/* reserve space for timestamp so it never overlaps on one-line */
.bubble p{margin:0;white-space:pre-wrap;word-break:break-word;line-height:1.55;font-size:15px;padding-right:64px}
.row.left .bubble p{padding-right:64px}
.row.right .bubble p{padding-right:64px}

.bubble .attach{color:inherit;text-decoration:underline;opacity:.9;font-size:14px}
.bubble .attach:hover{opacity:1}

/* timestamp */
.bubble .time{position:absolute;right:12px;bottom:6px;font-size:11px;color:currentColor;opacity:.6;white-space:nowrap}
.bubble.me .time{color:rgba(255,255,255,.85)}

/* tails removed for rounded look */
.bubble.tail::after{display:none}

/* kebab button */
.bubble .more{
  position:absolute;top:6px;right:8px;width:24px;height:24px;border-radius:6px;border:none;background:transparent;color:currentColor;opacity:.5;cursor:pointer
}
.bubble .more:hover{opacity:.95;background:rgba(0,0,0,.06)}
.bubble.me .more:hover{background:rgba(255,255,255,.12)}

/* reactions quick button (smiley) */
.bubble .react-btn{
  position:absolute;bottom:-18px;right:10px;width:26px;height:26px;border-radius:999px;border:1px solid var(--border);background:var(--panel);color:var(--text);cursor:pointer;font-size:14px;display:grid;place-items:center
}
.bubble .react-btn:hover{background:var(--hover)}
.bubble .voice-message{display:flex;align-items:center;gap:12px;margin-top:6px;padding:10px 12px;border-radius:14px;background:var(--voice-chip-bg);width:min(320px,100%);color:inherit;padding-right:56px}
.bubble.me .voice-message{background:rgba(255,255,255,0.18);color:#fff}
.bubble.voice-only{padding:12px 16px 28px}
.bubble.voice-only .voice-message{margin-top:0;background:transparent;padding:0 60px 0 0;width:100%}
.bubble.me.voice-only .voice-message{background:transparent}
.bubble.attachment-only{background:transparent;box-shadow:none;padding:0;display:flex;flex-direction:column;align-items:flex-end}
.bubble.attachment-only.tail::after{display:none}
.bubble.attachment-only .more{top:10px;right:10px}
.bubble.attachment-only .time{position:static;margin-top:6px;padding-right:10px}
.bubble.attachment-only .react-btn{right:6px}
.bubble.attachment-only .voice-message{padding:10px 14px;border-radius:14px;width:100%;background:rgba(59,130,246,.09)}
.bubble.me.attachment-only .voice-message{background:rgba(0,0,0,.22)}
.voice-message.error{opacity:.7}
.voice-message .voice-control{width:38px;height:38px;border-radius:50%;border:none;display:grid;place-items:center;font-size:16px;cursor:pointer;background:var(--voice-control);color:var(--voice-control-text);transition:transform .18s ease,opacity .18s ease}
.bubble.me .voice-message .voice-control{background:rgba(0,0,0,0.22);color:#fff}
.voice-message .voice-control:hover{transform:scale(1.05)}
.voice-message .voice-control:active{transform:scale(.95)}
.voice-message .voice-control:disabled{cursor:not-allowed;opacity:.55}
.voice-message .voice-body{flex:1;display:flex;flex-direction:column;gap:6px;min-width:0}
.voice-wave{display:grid;grid-template-columns:repeat(60,1fr);align-items:flex-end;gap:2px;height:40px}
.voice-wave.loading{opacity:.45;animation:voicePulse 1.1s ease-in-out infinite}
.voice-wave-bar{width:100%;height:100%;min-height:6px;border-radius:999px;transform-origin:bottom center;transform:scaleY(var(--bar-scale, .2));background:var(--wave-passive);opacity:.45;transition:transform .18s ease,opacity .18s ease,background .18s ease}
.bubble.me .voice-wave-bar{background:rgba(255,255,255,0.85);opacity:.5}
.voice-wave-bar.active{opacity:1;background:var(--wave-active)}
.voice-meta{display:flex;justify-content:space-between;align-items:center;font-size:.78rem;opacity:.88}
.voice-time{font-variant-numeric:tabular-nums}
.voice-download{color:inherit;opacity:.75;text-decoration:none;font-weight:500}
.voice-download:hover{opacity:1;text-decoration:underline}
@keyframes voicePulse{0%,100%{opacity:.35}50%{opacity:.8}}
.record-visual{display:flex;gap:4px;align-items:flex-end;height:32px;padding:0 4px}
.record-visual .bar{width:4px;border-radius:999px;background:var(--ring);transform-origin:bottom center;transition:transform .08s linear}

/* reactions chips under bubble */
.rxn-chips{display:flex;gap:6px;margin-top:6px}
.rxn-chip{font-size:12px;line-height:18px;background:rgba(0,0,0,.06);padding:2px 8px;border-radius:999px;display:inline-flex;align-items:center;gap:4px}
html:not(.light) .rxn-chip{background:rgba(255,255,255,.12)}

/* composer */
.composer{display:grid;grid-template-columns:auto 1fr auto;gap:10px;padding:14px 20px;border-top:1px solid var(--border);background:var(--panel);position:sticky;bottom:0;align-items:center}
.composer-left{display:flex;gap:8px;align-items:center;position:relative}
.icon-btn{width:36px;height:36px;border-radius:10px;border:1px solid var(--border);background:var(--elev);color:var(--text);cursor:pointer}
.icon-btn:hover{background:var(--hover)}
.attach-menu{position:absolute;bottom:48px;left:0;background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:6px;box-shadow:0 12px 30px rgba(0,0,0,.25)}
.attach-item{display:block;width:190px;padding:10px 12px;border-radius:8px;color:var(--text);background:transparent;border:none;text-align:left;cursor:pointer}
.attach-item:hover{background:var(--hover)}
.composer input{flex:1;padding:12px 16px;border-radius:12px;border:1px solid var(--border);background:var(--elev);color:var(--text);font-size:15px;outline:none;transition:all .2s}
.composer input::placeholder{color:var(--muted)}
.composer input:focus{border-color:var(--ring);background:var(--panel);box-shadow:0 0 0 3px rgba(59,130,246,.12)}
.send{width:44px;height:44px;border-radius:50%;border:none;background:var(--ring);color:#fff;font-size:18px;cursor:pointer;display:grid;place-items:center;transition:all .2s;flex-shrink:0}
.send:hover{transform:scale(1.05)}
.send:active{transform:scale(.96)}
.send.mic{font-size:20px}
.send.mic.recording{background:#ef4444}

/* context base (reused by MessageMenu and ReactionsBar) */
.ctx-wrap{position:fixed;inset:0;z-index:30}
.menu.ctx{position:absolute;transform:translate(-50%,6px);min-width:220px;padding:6px;border-radius:12px;background:var(--panel);border:1px solid var(--border);box-shadow:0 10px 30px rgba(0,0,0,.25)}
.modal-wrap{position:fixed;inset:0;z-index:40;display:flex;align-items:center;justify-content:center;padding:24px;background:rgba(0,0,0,.45)}
.modal-surface{position:relative;width:100%;max-height:calc(100vh - 80px);overflow:auto;border-radius:18px;background:var(--panel);border:1px solid var(--border);box-shadow:0 22px 60px rgba(0,0,0,.4);padding:20px}
.lightbox-wrap{position:fixed;inset:0;z-index:50;background:rgba(0,0,0,.65);display:flex;align-items:center;justify-content:center;padding:24px}
.lightbox-inner{position:relative;max-width:90vw;max-height:90vh}
.lightbox-img{max-width:100%;max-height:100%;border-radius:16px;object-fit:contain;display:block}
.lightbox-close{position:absolute;top:-18px;right:-18px;width:36px;height:36px;border-radius:50%;border:none;background:rgba(0,0,0,.6);color:#fff;font-size:20px;cursor:pointer}
.lightbox-close:hover{background:rgba(0,0,0,.8)}
.menu-item{width:100%;text-align:left;padding:10px 12px;background:transparent;border:none;color:var(--text);cursor:pointer;border-radius:8px}
.menu-item:hover{background:var(--hover)}
.menu-item.danger{color:#ef4444}
.jump-highlight{box-shadow:0 0 0 2px rgba(59,130,246,.4);transition:box-shadow .4s ease}
.jump-highlight.voice-only{box-shadow:0 0 0 2px rgba(59,130,246,.4)}
.jump-highlight.attachment-only{box-shadow:none}
.jump-highlight.attachment-only .media-frame{box-shadow:0 0 0 3px rgba(59,130,246,.35)}
.jump-highlight.attachment-only.voice-only{box-shadow:0 0 0 2px rgba(59,130,246,.4)}
.jump-highlight.attachment-only.voice-only .media-frame{box-shadow:none}

.forward-modal{width:min(420px,90vw);display:flex;flex-direction:column;gap:12px}
.forward-head{display:flex;justify-content:space-between;align-items:flex-start;gap:12px}
.forward-head h4{margin:0;font-size:1rem;color:var(--text)}
.forward-preview{margin:4px 0 0;font-size:.85rem;opacity:.75}
.forward-close{border:none;background:transparent;color:var(--muted);cursor:pointer;font-size:18px}
.forward-close:hover{color:var(--text)}
.forward-search input{width:100%;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:var(--elev);color:var(--text)}
.forward-search textarea{width:100%;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:var(--elev);color:var(--text);resize:vertical;min-height:72px}
.forward-list{max-height:220px;overflow-y:auto;border:1px solid var(--border);border-radius:12px;padding:8px 10px;background:var(--panel)}
.forward-list ul{list-style:none;margin:0;padding:0;display:grid;gap:6px}
.forward-list li{display:flex;align-items:center}
.forward-list label{display:flex;align-items:center;gap:10px;cursor:pointer;width:100%;padding:6px 4px;border-radius:8px}
.forward-list label:hover{background:var(--hover)}
.forward-list input[type="checkbox"]{accent-color:var(--ring)}
.forward-room-name{flex:1;overflow:hidden;text-overflow:ellipsis}
.forward-hint{font-size:.85rem;opacity:.7;text-align:center;padding:20px 0}
.forward-actions{display:flex;align-items:center;justify-content:flex-end;gap:10px}
.forward-count{margin-right:auto;font-size:.85rem;opacity:.7}
.forward-btn{border:1px solid var(--border);background:var(--subtle);color:var(--text);padding:6px 12px;border-radius:8px;cursor:pointer}
.forward-btn.ghost{background:transparent}
.forward-btn.primary{background:var(--ring);color:#fff;border-color:var(--ring)}
.forward-btn:disabled{opacity:.6;cursor:not-allowed}
.invite-modal{width:min(460px,92vw);display:flex;flex-direction:column;gap:12px}

/* right drawer */
.room-info{position:fixed;top:60px;right:-340px;width:320px;height:calc(100vh - 60px);background:var(--panel);border-left:1px solid var(--border);box-shadow:-6px 0 24px rgba(0,0,0,.15);transition:right .2s;z-index:12;padding:14px 16px;overflow-y:auto}
.room-info.open{right:0}
.room-info-hd{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.ri-meta h4{margin:0;color:var(--text)}
.ri-meta p{margin:2px 0 0;color:var(--muted);font-size:13px}
.ri-section{margin-top:16px}
.ri-title{font-weight:600;color:var(--text);margin-bottom:8px}
.ri-list{list-style:none;margin:0;padding:0}
.ri-list li{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid rgba(0,0,0,.06)}
.ri-avatar{width:28px;height:28px;min-width:28px;border-radius:50%;overflow:hidden;display:grid;place-items:center;font-size:13px;font-weight:700;color:#fff;background:linear-gradient(135deg,#3b82f6,#06b6d4)}
.ri-name{flex:1;color:var(--text);overflow:hidden;text-overflow:ellipsis}
.ri-action{border:none;background:transparent;color:#ef4444;cursor:pointer}
.ri-close{margin-left:auto;border:0;background:transparent;font-size:18px;color:var(--muted);cursor:pointer}
.ri-close:hover{color:var(--text)}

@media (max-width:768px){
  .row{max-width:85%}
  .chat-hd{padding:10px 16px}
  .composer{padding:12px 16px}
}


.message-info{max-width:320px;padding:16px;transform:translate(-50%,0);display:block}
.message-info h4{margin:0 0 8px;font-size:1rem}
.message-info dl{margin:0;display:grid;grid-template-columns:auto 1fr;gap:6px 12px;font-size:.9rem}
.message-info dt{opacity:.7}
.message-info dd{margin:0}

.selection-bar{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;border-bottom:1px solid var(--border);background:var(--panel);position:sticky;top:0;z-index:5}
.selection-bar .actions{display:flex;gap:8px}
.selection-bar button{border:1px solid var(--border);background:var(--elev);color:var(--text);padding:6px 10px;border-radius:8px;cursor:pointer}

.bubble.selected{box-shadow:0 0 0 2px var(--ring)}
.select-checkbox{margin-right:10px;align-self:flex-start}
.pin-flag{font-size:.75rem;display:inline-flex;align-items:center;gap:4px;background:rgba(59,130,246,.12);color:var(--ring);padding:2px 8px;border-radius:999px;margin-bottom:6px}
.meta-row{display:flex;gap:12px;align-items:center;margin-bottom:6px}
.meta-row .star{color:#fbbf24}
.note-chip{display:inline-block;background:rgba(94,234,212,.12);border:1px solid rgba(94,234,212,.4);padding:2px 8px;border-radius:999px;font-size:.75rem;margin-top:6px}


.media-attachment{margin-top:6px;width:min(340px,100%);display:flex;flex-direction:column;gap:8px}
.media-attachment .media-frame{position:relative;border-radius:16px;overflow:hidden;background:rgba(0,0,0,.18)}
.bubble.me .media-attachment .media-frame{background:rgba(0,0,0,.28)}
.media-attachment.image img,
.media-attachment.video video{display:block;width:100%;height:auto;max-height:440px;object-fit:cover}
.media-attachment.video video{background:rgba(0,0,0,.38)}
.media-meta{display:flex;justify-content:space-between;align-items:center;font-size:.8rem;opacity:.85}
.media-meta a{color:inherit;opacity:.75;text-decoration:none}
.media-meta a:hover{opacity:1;text-decoration:underline}
.reply-preview{padding:8px 10px;border-radius:10px;background:rgba(255,255,255,.05);font-size:.85rem;margin-bottom:6px}
.reply-preview.actionable{cursor:pointer;outline:none;border:none}
.reply-preview.actionable:focus-visible{box-shadow:0 0 0 2px var(--ring)}
.reply-preview strong{display:block;margin-bottom:4px}


.composer-context{margin:0 12px 8px;border:1px solid var(--border);background:var(--panel);border-radius:10px;padding:6px 10px;display:flex;justify-content:space-between;align-items:center;font-size:.85rem}
.composer-context button{border:none;background:transparent;color:var(--text);cursor:pointer;font-size:14px}

.reply-indicator{font-size:.75rem;opacity:.7}

.info-body{display:grid;gap:8px}
.info-body dl{margin:0}


.message-menu{min-width:168px;padding:4px 0;border-radius:10px;}
.message-menu .menu-item{display:flex;align-items:center;gap:8px;font-size:.85rem;padding:6px 10px;line-height:1.3;}
.message-menu .menu-item:disabled{opacity:.6;cursor:not-allowed}
.message-menu .menu-icon{display:inline-flex;align-items:center;justify-content:center;font-size:1rem;opacity:.75}
.menu-separator{height:1px;background:var(--border);margin:4px 0}
